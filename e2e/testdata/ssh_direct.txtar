# Direct SSH to public instance tests - Basic
# These tests rely on the default address resolution order: public → ipv6 → private

# Test SSH to public instance by ID using user@target syntax
exec ec2ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $USER@$PUBLIC_ID -- echo hello-public
stdout 'hello-public'

# Test SSH with hostname command using -l user target syntax
exec ec2ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -l $USER $PUBLIC_ID -- hostname
stdout .

# Test SSH with multiple command arguments using user@target syntax
exec ec2ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $USER@$PUBLIC_ID -- echo hello multiple args
stdout 'hello multiple args'

# Test SSH with environment variable using -l user target syntax
exec ec2ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -l $USER $PUBLIC_ID -- printenv HOME
stdout '/home/ec2-user'

# Test SSH to public instance by name tag
exec ec2ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $USER@$PUBLIC_NAME -- echo hello-by-name
stdout 'hello-by-name'

# Test --address-type public (explicit, default behavior)
exec ec2ssh --address-type public -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $USER@$PUBLIC_ID -- echo atype-public
stdout 'atype-public'

# Test --destination-type id
exec ec2ssh --destination-type id -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $USER@$PUBLIC_ID -- echo dtype-id
stdout 'dtype-id'

# Test --destination-type public_ip
exec ec2ssh --destination-type public_ip -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $USER@$PUBLIC_IP -- echo dtype-public-ip
stdout 'dtype-public-ip'

# Test --destination-type name_tag
exec ec2ssh --destination-type name_tag -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $USER@$PUBLIC_NAME -- echo dtype-name
stdout 'dtype-name'

# Test ssh:// URL format with instance ID
exec ec2ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null ssh://$USER@$PUBLIC_ID -- echo url-ssh
stdout 'url-ssh'

# Test ssh:// URL format with IP address
exec ec2ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null ssh://$USER@$PUBLIC_IP -- echo url-ip
stdout 'url-ip'

