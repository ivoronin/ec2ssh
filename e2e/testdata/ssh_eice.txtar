# EICE tunnel SSH to private instance tests - Basic

# Test EICE SSH to private instance by ID using user@target syntax
exec ec2ssh --eice-id $EICE_ID -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $USER@$PRIVATE_ID -- echo hello-eice
stdout 'hello-eice'

# Test EICE SSH to private instance by private IP using -l user target syntax
exec ec2ssh --eice-id $EICE_ID -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -l $USER $PRIVATE_IP -- echo hello-eice-ip
stdout 'hello-eice-ip'

# Test EICE SSH with hostname command using user@target syntax
exec ec2ssh --eice-id $EICE_ID -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $USER@$PRIVATE_ID -- hostname
stdout .

# Test EICE auto-detection: --use-eice WITHOUT --eice-id (auto-detects EICE by VPC/subnet)
exec ec2ssh --use-eice -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -l $USER $PRIVATE_ID -- echo hello-eice-autodetect
stdout 'hello-eice-autodetect'

